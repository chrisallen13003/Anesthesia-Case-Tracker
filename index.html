<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SRNA Case Tracker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(to bottom, #e6f3fa, #f0f9fa);
    }
    .form-container {
      background: white;
      border-radius: 0.75rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .case-item:nth-child(even) {
      background: #f1f5f9;
    }
    .case-item:hover {
      background: #e2e8f0;
      transition: background 0.2s;
    }
    .btn-primary {
      background: #1d4ed8;
      transition: background 0.3s;
    }
    .btn-primary:hover {
      background: #1e40af;
    }
  </style>
</head>
<body class="flex items-center justify-center min-h-screen">
  <div class="w-full max-w-4xl p-6 form-container">
    <h1 class="text-3xl font-bold text-center text-teal-700 mb-8">SRNA Case Tracker</h1>
    <div id="userPrompt" class="mb-6">
      <label for="username" class="block text-sm font-medium text-teal-800">Enter Your Username</label>
      <input type="text" id="username" name="username" placeholder="e.g., YourName123" required class="mt-1 block w-full p-2 border border-teal-300 rounded-md focus:ring-teal-500 focus:border-teal-500">
      <button id="setUsername" class="mt-2 w-full btn-primary text-white p-3 rounded-md">Set Username</button>
    </div>
    <form id="caseForm" class="grid grid-cols-1 md:grid-cols-2 gap-4 hidden">
      <div>
        <label for="date" class="block text-sm font-medium text-teal-800">Date</label>
        <input type="date" id="date" name="date" required class="mt-1 block w-full p-2 border border-teal-300 rounded-md focus:ring-teal-500 focus:border-teal-500">
      </div>
      <div>
        <label for="startTime" class="block text-sm font-medium text-teal-800">Anesthesia Start Time</label>
        <input type="time" id="startTime" name="startTime" required class="mt-1 block w-full p-2 border border-teal-300 rounded-md focus:ring-teal-500 focus:border-teal-500">
      </div>
      <div>
        <label for="stopTime" class="block text-sm font-medium text-teal-800">Anesthesia Stop Time</label>
        <input type="time" id="stopTime" name="stopTime" required class="mt-1 block w-full p-2 border border-teal-300 rounded-md focus:ring-teal-500 focus:border-teal-500">
      </div>
      <div>
        <label for="age" class="block text-sm font-medium text-teal-800">Patient Age</label>
        <input type="number" id="age" name="age" min="0" max="120" placeholder="e.g., 45" required class="mt-1 block w-full p-2 border border-teal-300 rounded-md focus:ring-teal-500 focus:border-teal-500">
      </div>
      <div>
        <label for="asaStatus" class="block text-sm font-medium text-teal-800">ASA Status</label>
        <select id="asaStatus" name="asaStatus" required class="mt-1 block w-full p-2 border border-teal-300 rounded-md focus:ring-teal-500 focus:border-teal-500">
          <option value="" disabled selected>Select ASA Status</option>
          <option value="1">ASA 1</option>
          <option value="2">ASA 2</option>
          <option value="3">ASA 3</option>
          <option value="4">ASA 4</option>
          <option value="5">ASA 5</option>
          <option value="6">ASA 6</option>
          <option value="1E">ASA 1E</option>
          <option value="2E">ASA 2E</option>
          <option value="3E">ASA 3E</option>
          <option value="4E">ASA 4E</option>
          <option value="5E">ASA 5E</option>
          <option value="6E">ASA 6E</option>
        </select>
      </div>
      <div>
        <label for="caseType" class="block text-sm font-medium text-teal-800">Type of Case</label>
        <input type="text" id="caseType" name="caseType" placeholder="e.g., General, OB, Neuro, Trauma, etc." required class="mt-1 block w-full p-2 border border-teal-300 rounded-md focus:ring-teal-500 focus:border-teal-500">
      </div>
      <div class="md:col-span-2">
        <label for="notes" class="block text-sm font-medium text-teal-800">Notes</label>
        <textarea id="notes" name="notes" rows="4" placeholder="e.g., Anesthesia Procedures (Art-line, CVC, POCUS), Anesthesia Type (General, Regional, MAC, Induction)" class="mt-1 block w-full p-2 border border-teal-300 rounded-md focus:ring-teal-500 focus:border-teal-500"></textarea>
      </div>
      <div class="md:col-span-2">
        <button type="submit" class="w-full btn-primary text-white p-3 rounded-md">Save Case</button>
      </div>
    </form>
    <div id="caseList" class="mt-8 hidden">
      <h2 class="text-xl font-semibold text-teal-700 mb-4">Saved Cases</h2>
      <ul id="cases" class="space-y-2"></ul>
    </div>
  </div>
  <script>
    // Get or set username
    let username = localStorage.getItem('srnaUsername') || '';
    let cases = [];

    const userPrompt = document.getElementById('userPrompt');
    const caseForm = document.getElementById('caseForm');
    const caseList = document.getElementById('caseList');

    // Show form if username is set, otherwise show username prompt
    if (username) {
      userPrompt.classList.add('hidden');
      caseForm.classList.remove('hidden');
      caseList.classList.remove('hidden');
      loadCases();
    }

    // Handle username submission
    document.getElementById('setUsername').addEventListener('click', () => {
      username = document.getElementById('username').value.trim();
      if (username) {
        localStorage.setItem('srnaUsername', username);
        userPrompt.classList.add('hidden');
        caseForm.classList.remove('hidden');
        caseList.classList.remove('hidden');
        loadCases();
      } else {
        alert('Please enter a username.');
      }
    });

    // Load cases for the current user
    function loadCases() {
      cases = JSON.parse(localStorage.getItem(`srnaCases_${username}`)) || [];
      displayCases();
    }

    // Handle form submission
    document.getElementById('caseForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const caseData = {
        date: document.getElementById('date').value,
        startTime: document.getElementById('startTime').value,
        stopTime: document.getElementById('stopTime').value,
        age: document.getElementById('age').value,
        asaStatus: document.getElementById('asaStatus').value,
        caseType: document.getElementById('caseType').value,
        notes: document.getElementById('notes').value,
        id: Date.now(), // Simple unique ID
        username: username // Tie case to user
      };
      cases.push(caseData);
      localStorage.setItem(`srnaCases_${username}`, JSON.stringify(cases));
      displayCases();
      document.getElementById('caseForm').reset();
    });

    // Display saved cases
    function displayCases() {
      const caseList = document.getElementById('cases');
      caseList.innerHTML = '';
      cases.forEach((c, index) => {
        if (c.username === username) {
          const li = document.createElement('li');
          li.className = 'p-3 case-item border border-teal-200 rounded-md';
          li.innerHTML = `
            <strong>Date:</strong> ${c.date}<br>
            <strong>Start/Stop:</strong> ${c.startTime} - ${c.stopTime}<br>
            <strong>Age:</strong> ${c.age}<br>
            <strong>ASA:</strong> ${c.asaStatus}<br>
            <strong>Case Type:</strong> ${c.caseType}<br>
            <strong>Notes:</strong> ${c.notes || 'None'}
          `;
          caseList.appendChild(li);
        }
      });
    }
  </script>
</body>
</html>
